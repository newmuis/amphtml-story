(self.AMP=self.AMP||[]).push({n:"amp-story",v:"1498233149596",f:(function(AMP){var e;function l(a,b){function c(){}c.prototype=b.prototype;a.prototype=new c;a.prototype.constructor=a;for(var d in b)if(Object.defineProperties){var k=Object.getOwnPropertyDescriptor(b,d);k&&Object.defineProperty(a,d,k)}else a[d]=b[d]}
var m="function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){if(c.get||c.set)throw new TypeError("ES3 does not support getters and setters.");a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)},p=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global?global:a}(this);function q(){q=function(){};p.Symbol||(p.Symbol=r)}var t=0;function r(a){return"jscomp_symbol_"+(a||"")+t++}
function u(){q();var a=p.Symbol.iterator;a||(a=p.Symbol.iterator=p.Symbol("iterator"));"function"!=typeof Array.prototype[a]&&m(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return v(this)}});u=function(){}}function v(a){var b=0;return y(function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}})}function y(a){u();var b={next:a};b[p.Symbol.iterator]=function(){return this};return b}function z(a){u();var b=a[Symbol.iterator];return b?b.call(a):v(a)};Date.now();self.log=self.log||{user:null,dev:null};var A=self.log;function B(){if(A.user)return A.user;throw Error("failed to call initLogConstructor");}function C(){if(A.dev)return A.dev;throw Error("failed to call initLogConstructor");};function D(a){a=a.__AMP_TOP||a;var b=a.services;b||(b=a.services={});a=b.vsync;a.obj||(a.obj=new a.ctor(a.context),a.ctor=null,a.context=null,a.resolve&&a.resolve(a.obj));return a.obj};function E(a,b,c){for(var d=a;d&&d!==c;d=d.parentElement)if(b(d))return d;return null};var F,G="Webkit webkit Moz moz ms O o".split(" ");function J(a){AMP.BaseElement.apply(this,arguments)}l(J,AMP.BaseElement);J.prototype.isLayoutSupported=function(a){return"container"==a};AMP.registerElement("amp-story-grid-layer",J);function K(a){AMP.BaseElement.apply(this,arguments)}l(K,AMP.BaseElement);K.prototype.isLayoutSupported=function(a){return"container"==a};AMP.registerElement("amp-story-page",K);function L(a){this.g=a;this.i=!1;this.b=null;this.m=!1;this.l=this.f=null}
L.prototype.build=function(){if(this.i)return this.getRoot();this.i=!0;this.b=this.g.document.createElement("aside");this.b.classList.add("i-amp-story-system-layer");this.b.innerHTML='<div class="i-amp-story-progress">\n      <div class="i-amp-story-progress-bar"></div>\n      <div class="i-amp-story-progress-value"></div>\n    </div>\n    <div class="i-amp-story-ui-right">\n      <div role="button" class="i-amp-story-exit-fullscreen i-amp-story-button" hidden>\n        <svg fill="#FFFFFF" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">\n          <path d="M0 0h24v24H0z" fill="none"/>\n          <path d="M5 16h3v3h2v-5H5v2zm3-8H5v2h5V5H8v3zm6 11h2v-3h3v-2h-5v5zm2-11V5h-2v5h5V8h-3z"/>\n        </svg>\n      </div>\n      <div div role="button" class="i-amp-story-bookend-close" hidden>\n        <svg fill="#FFFFFF" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">\n          <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>\n          <path d="M0 0h24v24H0z" fill="none"/>\n        </svg>\n      </div role="button">\n    </nav>';this.f=
this.b.querySelector(".i-amp-story-exit-fullscreen");this.l=this.b.querySelector(".i-amp-story-progress-value");M(this);return this.getRoot()};function M(a){a.f.addEventListener("click",function(b){b.stopPropagation();b=a.getRoot();var c=new Event("ampstory:exitfullscreen",{bubbles:!0});c.initEvent&&c.initEvent("ampstory:exitfullscreen",!0);b.dispatchEvent(c)})}L.prototype.getRoot=function(){return this.b};L.prototype.setInFullScreen=function(a){this.m=a;N(this,a)};
function N(a,b){D(a.g).mutate(function(){b?a.f.removeAttribute("hidden"):a.f.setAttribute("hidden","hidden")})}
L.prototype.updateProgressBar=function(a,b){var c=this,d=a/b;D(this.g).mutate(function(){var a=c.l,b={transform:"scale("+(d+",1")+")"},w;for(w in b){var H=a,W=b[w],g;g=H.style;var h=w;if(2>h.length?0:0==h.lastIndexOf("--",0))g=h;else{F||(F=Object.create(null));var n=F[h];if(!n){n=h;if(void 0===g[h]){var f;f=h;f=f.charAt(0).toUpperCase()+f.slice(1);b:{for(var x=0;x<G.length;x++){var I=G[x]+f;if(void 0!==g[I]){f=I;break b}}f=""}void 0!==g[f]&&(n=f)}F[h]=n}g=n}g&&(H.style[g]=W)}})};function O(a){return!!(a.requestFullscreen||a.webkitRequestFullScreen||a.mozRequestFullScreen||a.msRequestFullscreen)};function P(a){AMP.BaseElement.call(this,a);this.h=!0;this.s=this.getVsync();this.a=null;this.c=new L(this.win);this.j=[]}l(P,AMP.BaseElement);e=P.prototype;
e.buildCallback=function(){var a=this;this.a=this.win.document.createElement("section");this.a.classList.add("i-amp-story-bookend");this.a.textContent="bookend goes here";this.element.appendChild(this.a);this.element.appendChild(this.c.build());this.element.addEventListener("click",this.o.bind(this),!0);this.element.addEventListener("ampstory:exitfullscreen",function(){Q(a,!0)});this.win.document.addEventListener("keydown",function(b){switch(b.keyCode){case 37:R(a);break;case 39:S(a)}},!0);var b=
B().assertElement(this.element.querySelector("amp-story-page"),"Story must have at least one page.");b.setAttribute("active","");this.scheduleResume(b);for(var c=this.element.querySelectorAll("amp-video"),d=z(c),k=d.next();!k.done;k=d.next()){var V=k.value;V.setAttribute("autoplay","")}};e.layoutCallback=function(){var a=T(this);a&&this.schedulePreload(a);return Promise.resolve()};e.isLayoutSupported=function(a){return"container"==a};
function U(a){var b=a.element.querySelector("amp-story-page[active]");return b}function T(a){var b=U(a),c=b.getAttribute("advance-to");return c?B().assert(a.element.querySelector("amp-story-page#"+c),'Page "'+b.id+'" refers to page "'+c+'", but no such page exists.'):b.nextElementSibling===a.c.getRoot()||b.nextElementSibling===a.a?null:b.nextElementSibling}function S(a){var b=U(a),c=T(a);c&&X(a,c).then(function(){return a.j.push(b)}).then(function(){var b=T(a);b&&a.schedulePreload(b)})}
function R(a){var b=a.j.pop();b&&X(a,b)}function X(a,b){var c=U(a);O(a.element)&&(b===a.a?Q(a):a.h&&Y(a));a.c.updateProgressBar(a.getPageIndex(b),a.getPageCount()-1);return a.mutateElement(function(){b.setAttribute("active","");c.removeAttribute("active")},b).then(function(){a.schedulePause(c);a.scheduleResume(b)})}e.setAutoFullScreen=function(a){this.h=a};
function Y(a){a.c.setInFullScreen(!0);a=a.element;a.requestFullscreen?a.requestFullscreen():a.webkitRequestFullScreen?a.webkitRequestFullScreen():a.mozRequestFullScreen?a.mozRequestFullScreen():a.msRequestFullscreen?a.msRequestFullscreen():C().warn("Ignored fullscreen request.")}
function Q(a,b){b&&a.setAutoFullScreen(!1);a.c.setInFullScreen(!1);a=a.element.ownerDocument;a.exitFullscreen?a.exitFullscreen():a.webkitExitFullscreen?a.webkitExitFullscreen():a.mozCancelFullScreen?a.mozCancelFullScreen():a.msExitFullscreen?a.msExitFullscreen():C().warn("Ignored fullscreen request.")}e.o=function(a){if(Z(this,a)){var b=.25*this.getViewport().getWidth();a.pageX>=b?S(this):R(this);a.stopPropagation()}};
function Z(a,b){return!E(b.target,function(b){return b===a.c.getRoot()||b===a.a},a.element)}e.getPages=function(){return this.element.querySelectorAll("amp-story-page")};e.getPageCount=function(){return this.getPages().length};e.getPageIndex=function(a){return Array.prototype.indexOf.call(this.getPages(),a)};AMP.registerElement("amp-story",P,'amp-story,amp-story-grid-layer,amp-story-page{contain:strict!important;overflow:hidden!important}amp-story{height:100%!important;position:relative!important;width:100%!important}body>amp-story{height:100vh!important}.i-amp-story-system-layer{background:-webkit-linear-gradient(top,rgba(0,0,0,.8),transparent);background:linear-gradient(to bottom,rgba(0,0,0,.8),transparent);position:absolute;top:0;left:0;right:0;height:44px;z-index:100000;padding:4px 0 0;box-sizing:border-box}.i-amp-story-ui-right{float:right}.i-amp-story-button{margin:0 8px;height:40px;width:40px;cursor:pointer;border-radius:40px;box-sizing:border-box;padding:8px}.i-amp-story-button:active{background:rgba(0,0,0,.2)}.i-amp-story-progress-bar,.i-amp-story-progress-value{position:absolute;left:0;right:0;top:0;height:4px}.i-amp-story-progress-bar{background:hsla(0,0%,100%,.25)}.i-amp-story-progress-value{background:#fff;width:100%;-webkit-transform:translateZ(0) scaleX(0);transform:translateZ(0) scaleX(0);-webkit-transition:-webkit-transform 0.3s ease;transition:-webkit-transform 0.3s ease;transition:transform 0.3s ease;transition:transform 0.3s ease,-webkit-transform 0.3s ease;-webkit-transform-origin:left;transform-origin:left;will-change:transform}[dir=rtl] .i-amp-story-progress-value{-webkit-transform-origin:right;transform-origin:right}amp-story-page{bottom:0!important;display:none!important;left:0!important;position:absolute!important;right:0!important;top:0!important}amp-story-page[active]{display:block!important}amp-story-grid-layer{bottom:0!important;display:-ms-grid!important;display:grid!important;left:0!important;position:absolute!important;right:0!important;top:0!important;padding:68px 32px 32px}amp-story-grid-layer *{box-sizing:border-box!important;margin:0!important}amp-story-grid-layer[template=fill]>:not(:first-child){display:none!important}amp-story-grid-layer[template=fill]>:first-child{bottom:0!important;display:block!important;height:auto!important;left:0!important;position:absolute!important;right:0!important;top:0!important;width:auto!important}amp-story-grid-layer[template=fill]>amp-anim img,amp-story-grid-layer[template=fill]>amp-img img,amp-story-grid-layer[template=fill]>amp-video video{-o-object-fit:cover!important;object-fit:cover!important}amp-story-grid-layer[template=vertical]{-webkit-align-content:start;-ms-flex-line-pack:start;align-content:start;grid-auto-flow:row!important;grid-gap:16px;-ms-grid-columns:100%!important;grid-template-columns:100%!important;-webkit-box-pack:stretch;-webkit-justify-content:stretch;-ms-flex-pack:stretch;justify-content:stretch;-ms-grid-column-align:start;justify-items:start}amp-story-grid-layer[template=vertical]>*{width:100%}amp-story-grid-layer[template=horizontal]{-webkit-align-content:stretch;-ms-flex-line-pack:stretch;align-content:stretch;-webkit-box-align:start;-webkit-align-items:start;-ms-flex-align:start;align-items:start;grid-auto-flow:column!important;grid-gap:16px;-ms-grid-rows:100%!important;grid-template-rows:100%!important;-webkit-box-pack:start;-webkit-justify-content:start;-ms-flex-pack:start;justify-content:start}amp-story-grid-layer[template=thirds]{-ms-grid-rows:(auto)[3]!important;grid-template-rows:repeat(3,auto)!important;grid-template-areas:"upper-third" "middle-third" "lower-third"!important}.i-amp-story-bookend{display:none!important}\n/*# sourceURL=/extensions/amp-story/0.1/amp-story.css*/');
})});
//# sourceMappingURL=amp-story-0.1.js.map

